<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chatbot Interface</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/chat.css') }}">
    <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}">
</head>

<body>
        {% if is_authenticated %}
        <a href="/logout" id="logout-btn" class="logout-btn">Logout</a>
        {% endif %}
    <div id="container">
        <div id="menu-container">
            <div id="menu-header">
                <button class="menu-trigger" id="menu-button" title="Close Menu"><img
                        src="{{ url_for('static', filename='public/icons/menu.svg') }}" alt="Menu"></button>
            </div>
            <div id="menu-content">
                <div class="menu-item" id="instructions-container">
                    <h2>INSTRUCTIONS</h2>
                    <textarea class="menu-value" id="instructions-textarea"
                        placeholder="Enter your instructions for the generator..."></textarea>
                </div>
                <div class="horizontal-separator"></div>
                <div class="menu-item" id="conf-container">
                    <h2>CONFIDENCE VALUE</h2>
                    <p class="menu-value" id="conf-value">0%</p>
                </div>
                <div class="menu-item" id="exp-container">
                    <h2>EXPLANATION</h2>
                    <div class="menu-value" id="exp-value"></div>
                </div>
                <div class="menu-item" id="info-container">
                    <h2>MISSING INFORMATION</h2>
                    <div class="menu-value" id="info-value"></div>
                </div>
                <div class="menu-item" id="amb-container">
                    <h2>AMBIGUITY</h2>
                    <div class="menu-value" id="amb-value"></div>
                </div>
            </div>
            <div id="menu-footer">
                <p id="rights-reserved">All Rights Reserved (c) FalkorDB 2025 | <a class="link"
                        href="https://falkordb.com" target="_blank">falkordb.com</a></p>
            </div>
        </div>
        <div id="chat-container" class="chat-container">
            <button class="menu-trigger" id="side-menu-button" title="Open Menu"><img
                    src="{{ url_for('static', filename='public/icons/menu.svg') }}" alt="Menu"></button>
            <div class="chat-header">
                <img src="{{ url_for('static', filename='public/icons/logo.svg') }}" alt="Chat Logo" class="logo">
                <h1> Text-to-SQL(Natural Language to SQL Generator)</h1>
                <div class="button-container">
                    <select title="Select Database" id="graph-select">
                        <option value="">Loading...</option>
                    </select>
                    <div class="vertical-separator"></div>
                    <input title="Upload Schema" id="schema-upload" type="file" accept=".json" style="display: none;" tabindex="-1" />
                    <label for="schema-upload" id="custom-file-upload">
                        Upload Schema
                    </label>
                    <div class="vertical-separator"></div>
                    <label id="open-pg-modal">
                        Connect Postgres
                    </label>
                </div>
            </div>
            <div class="chat-messages" id="chat-messages">
            </div>
            <div class="chat-input">
                <div class="suggestions-input-container">
                    <ul class="suggestions-container" id="suggestions-container">
                        <li class="suggestion-item loading">
                            <button title="Loading suggestion..." id="suggestion-1">
                                <p></p>
                            </button>
                        </li>
                        <li class="suggestion-item loading">
                            <button title="Loading suggestion..." id="suggestion-2">
                                <p></p>
                            </button>
                        </li>
                        <li class="suggestion-item loading">
                            <button title="Loading suggestion..." id="suggestion-3">
                                <p></p>
                            </button>
                        </li>
                    </ul>
                    <div class="input-container" id="input-container">
                        <input type="text" id="message-input" placeholder="Describe the SQL query you want..." />
                        <button class="input-button" title="Submit" id="submit-button">
                            <img src="{{ url_for('static', filename='public/icons/submit.svg') }}" alt="Submit">
                        </button>
                        <button class="input-button" title="Pause" id="pause-button">
                            <img src="{{ url_for('static', filename='public/icons/pause.svg') }}" alt="Pause">
                        </button>
                        <button id="reset-button">Reset</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="gradient"></div>
    <div id="google-login-modal" class="google-login-modal">
        <div class="google-login-modal-content">
            <h2>Welcome to Text-to-SQL</h2>
            <p>Please login to continue</p>
            <a href="/login/google" class="google-login-btn">
                <img src="{{ url_for('static', filename='public/icons/google.svg') }}"  alt="Google logo" class="google-login-logo">Sign in with Google
            </a>
        </div>
    </div>
    <div id="pg-modal" class="pg-modal">
        <div class="pg-modal-content">
            <h2 class="pg-modal-title">Connect to Postgres</h2>
            <input type="text" id="pg-url-input" class="pg-modal-input" placeholder="postgres://user:pass@host:port/db" />
            <div class="pg-modal-actions">
                <button id="pg-modal-connect" class="pg-modal-btn pg-modal-connect">Connect</button>
                <button id="pg-modal-cancel" class="pg-modal-btn pg-modal-cancel">Cancel</button>
            </div>
        </div>
    </div>
    {# Set authentication state for JS before loading chat.js #}
    <script>
      window.isAuthenticated = {{ 'true' if is_authenticated else 'false' }};
    </script>
    <script src="{{ url_for('static', filename='js/chat.js') }}"></script>
</body>

</html>