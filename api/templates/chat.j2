<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chatbot Interface</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/chat.css') }}">
    <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}">
</head>

<body>
        {% if is_authenticated %}
        <a href="/logout" id="logout-btn" style="position:fixed;top:20px;right:30px;z-index:2000;padding:0.5em 1.2em;background:#e74c3c;color:#fff;border-radius:5px;text-decoration:none;font-weight:bold;box-shadow:0 2px 8px rgba(0,0,0,0.08);">Logout</a>
        {% endif %}
    <div id="container">
        <div id="menu-container">
            <div id="menu-header">
                <button class="menu-trigger" id="menu-button" title="Close Menu"><img
                        src="{{ url_for('static', filename='public/icons/menu.svg') }}" alt="Menu"></button>
            </div>
            <div id="menu-content">
                <div class="menu-item" id="instructions-container">
                    <h2>INSTRUCTIONS</h2>
                    <textarea class="menu-value" id="instructions-textarea"
                        placeholder="Enter your instructions for the generator..."></textarea>
                </div>
                <div class="horizontal-separator"></div>
                <div class="menu-item" id="conf-container">
                    <h2>CONFIDENCE VALUE</h2>
                    <p class="menu-value" id="conf-value">0%</p>
                </div>
                <div class="menu-item" id="exp-container">
                    <h2>EXPLANATION</h2>
                    <div class="menu-value" id="exp-value"></div>
                </div>
                <div class="menu-item" id="info-container">
                    <h2>MISSING INFORMATION</h2>
                    <div class="menu-value" id="info-value"></div>
                </div>
                <div class="menu-item" id="amb-container">
                    <h2>AMBIGUITY</h2>
                    <div class="menu-value" id="amb-value"></div>
                </div>
            </div>
            <div id="menu-footer">
                <p id="rights-reserved">All Rights Reserved (c) FalkorDB 2025 | <a class="link"
                        href="https://falkordb.com" target="_blank">falkordb.com</a></p>
            </div>
        </div>
        <div id="chat-container" class="chat-container">
            <button class="menu-trigger" id="side-menu-button" title="Open Menu"><img
                    src="{{ url_for('static', filename='public/icons/menu.svg') }}" alt="Menu"></button>
            <div class="chat-header">
                <img src="{{ url_for('static', filename='public/icons/logo.svg') }}" alt="Chat Logo" class="logo">
                <h1> Text-to-SQL(Natural Language to SQL Generator)</h1>
                <div class="button-container">
                    <select title="Select Database" id="graph-select">
                        <option value="">Loading...</option>
                    </select>
                    <div class="vertical-separator"></div>
                    <input title="Upload Schema" disabled id="schema-upload" type="file" accept=".json" style="display: none;" tabindex="-1" />
                    <label for="schema-upload" id="custom-file-upload" tabindex="-1">
                        Upload Schema
                    </label>
                    
                </div>
            </div>
            <div class="chat-messages" id="chat-messages">
            </div>
            <div class="chat-input">
                <div class="suggestions-input-container">
                    <ul class="suggestions-container" id="suggestions-container">
                        <li class="suggestion-item loading">
                            <button title="Loading suggestion..." id="suggestion-1">
                                <p></p>
                            </button>
                        </li>
                        <li class="suggestion-item loading">
                            <button title="Loading suggestion..." id="suggestion-2">
                                <p></p>
                            </button>
                        </li>
                        <li class="suggestion-item loading">
                            <button title="Loading suggestion..." id="suggestion-3">
                                <p></p>
                            </button>
                        </li>
                    </ul>
                    <div class="input-container" id="input-container">
                        <input type="text" id="message-input" placeholder="Describe the SQL query you want..." />
                        <button class="input-button" title="Submit" id="submit-button">
                            <img src="{{ url_for('static', filename='public/icons/submit.svg') }}" alt="Submit">
                        </button>
                        <button class="input-button" title="Pause" id="pause-button">
                            <img src="{{ url_for('static', filename='public/icons/pause.svg') }}" alt="Pause">
                        </button>
                        <button id="reset-button">Reset</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="gradient"></div>
    <div id="google-login-modal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.6); z-index:1000; align-items:center; justify-content:center;">
        <div style="background:#fff; padding:2em 3em; border-radius:10px; box-shadow:0 2px 16px rgba(0,0,0,0.2); text-align:center;">
            <h2>Welcome to Text-to-SQL</h2>
            <p>Please login to continue</p>
            <a href="/login/google" style="display:inline-block; margin-top:1em; padding:0.7em 2em; background:#4285F4; color:#fff; border-radius:4px; font-size:1.1em; text-decoration:none;">
                <img src="https://developers.google.com/identity/images/g-logo.png" alt="Google logo" style="height:20px; vertical-align:middle; margin-right:8px;">Login with Google
            </a>
        </div>
    </div>
    <script src="{{ url_for('static', filename='js/chat.js') }}"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var isAuthenticated = {% if is_authenticated %}true{% else %}false{% endif %};
            if (!isAuthenticated) {
                document.getElementById('google-login-modal').style.display = 'flex';
                document.getElementById('container').style.filter = 'blur(2px)';
            } else {
                document.getElementById('google-login-modal').style.display = 'none';
                document.getElementById('container').style.filter = '';
            }
        });
    </script>
</body>

</html>